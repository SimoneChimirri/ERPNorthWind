<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="SimoneChimirri">
    <meta name="descripton" content="Pagina di gestione dipendenti">
    <title>ERP NorthWind - Dipendenti</title>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script type="text/javascript" src="js/auth.js"></script>
    <script>
        function toggleMenubar() {
            var menulist = document.getElementById("menulist");
            if(menulist.classList.contains("collapsed")){
                menulist.classList.remove("collapsed");
                return;
            } else{
                menulist.classList.add("collapsed");
            }
        }

        function requireAuthAdmin(){
            if(!isAuthenticatedAdmin()){
                alert("Accesso non autorizzato. Solo gli amministratori possono accedere a questa pagina.");
                window.location.href = "index.html";
            }
        }
    </script>
</head>
<body onload="requireAuthAdmin(); caricaDipendenti()">
    <div class="wrapper container">
        <div id="top">
            <img id="logo" src="resources/images/NorthWind logo.png">
            <h1>NorthWind</h1>
            <p>ERP</p>
        </div>
        <div class="wrapper">
            <div id="menubar">
                <button id="toggleMenuButton" onclick="toggleMenubar()"><i class="fa fa-bars"></i></button>
                <ul id="menulist">
                    <li class="menuitem"><a href="index.html"><i class="fa fa-house"></i>Riepilogo</a></li>
                    <li class="menuitem"><a href="ordini.html"><i class="fa fa-list"></i>Ordini</a></li>
                    <li class="menuitem"><a href="prodotti_categorie.html"><i class="fa fa-box"></i>Prodotti e categorie</a></li>
                    <li class="menuitem"><a href="clienti.html"><i class="fa fa-person"></i>Clienti</a></li>
                    <li class="menuitem"><a href="spedizionieri_fornitori.html"><i class="fa fa-truck"></i>Spedizionieri e fornitori</a></li>
                    <li class="menuitem selected"><a href="dipendenti.html"><i class="fa fa-user"></i>Dipendenti</a></li>
                    <li class="menuitem"><a href="#" onclick="logout()"><i class="fa fa-sign-out-alt"></i>Logout</a></li>
                </ul>
            </div>
            <div id="main">
                <div id="mainHeader">
                    <h1>Gestione dipendenti</h1>
                    <div id="toolbar">
                        <div>
                            <input type="text" id="searchFieldDipendenti">
                            <input type="button" value="Cerca dipendente" class="btn" onclick="ricercaDipendenti()">
                        </div>
                        <div>
                            <input type="text" id="updateFieldDipendenti">
                            <input type="button" value="Aggiorna dipendente" class="btn" onclick="selezionaDipendente()">
                        </div>
                        <div>
                            <input type="button" value="Crea dipendente" class="btn" onclick="document.getElementById('sidebar').classList.remove('collapsed');">
                        </div>
                        <div>
                            <input type="text" id="deleteFieldDipendenti">
                            <input type="button" value="Elimina dipendente" class="btn" onclick="eliminaDipendente()">
                        </div>
                        <div>
                            <input type="button" value="Esporta dipendenti in formato Excel" class="btn" onclick="esportaDipendentiExcel()">
                        </div>
                    </div>
                </div>
                <table id="tableDipendenti">
                    <thead>
                        <tr>
                            <th data-index="EMPLOYEE_ID">Employee ID</th>
                            <th data-index="FIRSTNAME">First Name</th>
                            <th data-index="LASTNAME">Last Name</th>
                            <th data-index="TITLE">Title</th>
                            <th data-index="BIRTHDATE">Birth Date</th>
                            <th data-index="HIREDATE">Hire Date</th>
                            <th data-index="ADDRESS">Address</th>
                            <th data-index="CITY">City</th>
                            <th data-index="REGION">Region</th>
                            <th data-index="POSTAL_CODE">Postal Code</th>
                            <th data-index="COUNTRY">Country</th>
                            <th data-index="HOME_PHONE">Home Phone</th>
                            <th data-index="EXTENSION">Extension</th>
                            <th data-index="PHOTO">Photo</th>
                            <th data-index="NOTES">Notes</th>
                            <th data-index="MANAGER_FIRSTNAME">Manager First Name</th>
                            <th data-index="MANAGER_LASTNAME">Manager Last Name</th>
                            <th data-index="USERNAME">Username</th>
                            <th data-index="PASSWORD">Password</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="dipendentiTableData">
                    </tbody>
                </table>
            </div>
            <div id="sidebar" class="collapsed">
                <h3>Form Dipendente</h3>
                <form action="" method="POST" id="formDipendenti">
                    <label for="EMPLOYEE_ID">Employee ID:</label>
                    <input type="text" id="employeeID" name="EMPLOYEE_ID" readonly><br>

                    <label for="FIRSTNAME">First Name:</label>
                    <input type="text" id="firstName" name="FIRSTNAME"><br>

                    <label for="LASTNAME">Last Name:</label>
                    <input type="text" id="lastName" name="LASTNAME"><br>

                    <label for="TITLE">Title:</label>
                    <select id="title" name="TITLE">
                        <option value="1">Sales Representative</option>
                        <option value="2">Vice President, Sales</option>
                        <option value="3">Sales Manager</option>
                        <option value="4">Inside Sales Coordinator</option>
                        <option value="5">Marketing Manager</option>
                        <option value="6">IT Manager</option>
                        <option value="7">Other</option>
                    </select><br>

                    <label for="TITLE_OF_COURTESY">Title Of Courtesy:</label>
                    <select id="titleOfCourtesy" name="TITLE_OF_COURTESY">
                        <option value="1">Mr.</option>
                        <option value="2">Ms.</option>
                        <option value="3">Mrs.</option>
                        <option value="4">Dr.</option>
                        <option value="5">Prof.</option>
                        <option value="6">Sir.</option>
                        <option value="7">Other</option>
                    </select><br>

                    <label for="BIRTHDATE">Birth Date:</label>
                    <input type="date" id="birthDate" name="BIRTHDATE"><br>

                    <label for="HIREDATE">Hire Date:</label>
                    <input type="date" id="hireDate" name="HIREDATE"><br>
                    
                    <label for="ADDRESS">Address:</label>
                    <input type="text" id="address" name="ADDRESS"><br>

                    <label for="CITY">City:</label>
                    <input type="text" id="city" name="CITY"><br>

                    <label for="REGION">Region:</label>
                    <input type="text" id="region" name="REGION"><br>

                    <label for="POSTAL_CODE">Postal Code:</label>
                    <input type="text" id="postalCode" name="POSTAL_CODE"><br>

                    <label for="COUNTRY">Country:</label>
                    <input type="text" id="country" name="COUNTRY"><br>

                    <label for="HOME_PHONE">Home Phone:</label>
                    <input type="text" id="homePhone" name="HOME_PHONE"><br>

                    <label for="EXTENSION">Extension:</label>
                    <input type="text" id="extension" name="EXTENSION"><br>

                    <label for="PHOTO">Photo (URL):</label>
                    <input type="text" id="photo" name="PHOTO"><br>

                    <label for="NOTES">Notes:</label>
                    <textarea id="notes" name="NOTES"></textarea><br>

                    <label for="MANAGER_ID">Manager ID:</label>
                    <input type="text" id="managerID" name="MANAGER_ID"><br>

                    <label for="USERNAME">Username:</label>
                    <input type="number" id="username" name="USERNAME"><br>

                    <label for="PASSWORD">Password:</label>
                    <input type="current-password" id="password" name="PASSWORD"><br>

                    <input type="submit" value="Salva" class="btn">
                    <input type="reset" value="Cancella" class="btn">
                </form>
            </div>
    <script type="text/javascript" src="js/dipendenti.js"></script>
</body>
</html>